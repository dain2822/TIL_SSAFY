
## 250929

### [Objectives_ 학습 목표]

- Django Form이 무엇인지 설명할 수 있음
- Form을 통해 사용자 입력 데이터를 수집하고 처리할 수 있음
- Form 클래스 정의 및 유효성 검사를 직접 수행할 수 있음
- ModelForm을 활용하여 데이터 베이스와 연동되는 입력 폼을 생성할 수 있음
- Form과 ModelForm의 차이를 이해하고, 적절한 상황에 따라 선택하여 활용할 수 있음

---

### [Build_ 이론]

### Django Form

**HTML Form의 한계**

: 지금까지 사용자로부터 데이터를 제출 받기 위해 활용한 방법

→ 비정상적 또는 악의적인 요청을 필터링 할 수 없음

⇒ 유효한 데이터인지에 대한 확인이 필요함

**유효성 검사**

: 수집한 데이터가 정확하고 유효한지 확인하는 과정

→ Django Form의 유효성 검사는 사용자가 입력한 데이터가 올바른 형식인지 자동으로 점검하는 기능을 제공함

→ ex) 필수 입력 값이 비어 있거나 잘못된 이메일 형식을 입력하면 오류를 알려줌

→ 이 과정을 통해 서버에 잘못된 데이터가 저장되지 않도록 보호할 수 있음

**유효성 검사 구현의 어려움**

: 유효성 검사를 구현하기 위해서는 입력 값, 형식, 중복, 보안 등 많은 것들을 고려해야 함

: 이런 과정과 기능을 직접 개발하는 것이 아닌 Django가 제공하는 Form을 사용

**Django Form**

: 사용자 입력 데이터를 수집하고, 처리 및 유효성 검사를 수행하기 위한 도구

→ 유효성 검사를 단순화하고 자동화 할 수 있는 기능 제공

→ 사용자가 잘못 입력한 데이터는 자동으로 오류 처리되어 안전성을 높임

→ 개발자는 이를 통해 빠르고 일관된 검증 기능을 구현할 수 있음

**Form Class**

- Form Class를 상속받아 내용과 제목에 대한 사용자 입력을 받는 ArticleForm을 정의하는 방법

![image.png](attachment:21a7db56-a8ed-4f51-bc08-99abe56a0c84:image.png)

- view 함수 new 변경

![image.png](attachment:e000d03b-13d1-4ba3-8598-c87a1445306d:image.png)

- new 페이지에서 form 인스턴스 출력

![image.png](attachment:cd445e98-2107-46b6-bb6f-200b6370c4e3:image.png)

![image.png](attachment:0f56ec86-2c7a-42ab-aa93-d7b2a255c5c6:image.png)

- Form Class가 대체하는 것

![image.png](attachment:0049a56e-033f-4bbe-9534-1808b1894b9f:image.png)

### Widgets

: HTML ‘input’ element의 표현을 담당

: 폼 필드를 화면에 표시하는 HTML 입력 요소를 정의하는 구성 요소

→ Django Form의 widgets은 각 필드가 HTML에서 어떻게 렌더링 될 지를 결정함

ex) TextInput, Select, CheckboxInput 등 다양한 위젯 클래스를 사용해 입력 방식과 속성을 세부 조정할 수 있음

**Widget 적용**

: Widget은 단순히 input 요소의 속성 및 출력되는 부분을 변경하는 것

![image.png](attachment:1eead157-316d-4987-929e-eb5e25a27205:image.png)

### Django ModelForm

**Form vs. ModelForm**

- Form
    
    : 사용자 입력 데이터를 DB에 저장하지 않을 때(ex : 검색, 로그인)
    
- ModelForm
    
    : 사용자 입력 데이터를 DB에 저장해야 할 때(ex : 게시글 작성, 회원가입)
    

**ModelForm**

: Model과 연결된 Form을 자동으로 생성해주는 기능을 제공

→ ModelForm은 Form 클래스와 Model 클래스로 결합한 형태로, 모델 필드를 기반으로 입력 폼을 자동 생성함

→ 데이터 수집과 저장 과정을 동시에 처리할 수 있도록 도와줌

- 기존 ArticleForm 클래스 수정

![image.png](attachment:6945b6d0-fb8d-47ef-8df3-1bd4698c9b13:image.png)

![image.png](attachment:9e45eaa6-1b98-4137-856c-e23ed751829b:image.png)

- ModelForm class가 대체하는 것

![image.png](attachment:69ee83ae-0e15-45ab-9597-a51dc258c4ce:image.png)

### **Meta class**

: ModelForm의 정보를 작성하는 곳

→ Meta class는 ModelForm 내부에서 어떤 모델과 연결할 지, 어떤 필드를 사용할 지 등을 정의하는 설정 공간

→ 폼의 동작 방식을 제어하는 핵심 역할을 함

**fields 및 exclude 속성**

- excluede 속성을 사용하여 모델에서 포함하지 않도록 필드를 지정할 수도 있음

![image.png](attachment:e6a30e27-0d45-41ab-955e-932cad3f5d2d:image.png)

**Meta class 주의 사항**

: Django에서 ModelForm에 대한 추가 정보나 속성을 작성하는 클래스 구조를 Meta 클래스로 작성했을 뿐이며, 파이썬의 inner class와 같은 문법적인 관점으로 접근 X

**ModelForm을 적용한 create 로직**

![image.png](attachment:a500ca9b-6880-4cde-82eb-7c708710cf06:image.png)

- 제목 input에 공백을 입력 후 제출 시 에러 메시지 출력 확인
    
    → 유효성 검사의 결과
    
    ![image.png](attachment:c3667722-3cdd-4676-93c4-a1387c035f28:image.png)
    

**is_valid()**

: 여러 유효성 검사를 실행하고, 데이터가 유효한 지 여부를 Boolean으로 반환

- 공백 데이터가 유효하지 않은 이유와 에러 메시지가 출력되는 과정
    - 별도로 명시하지 않았지만 모델 필드에는 기본적으로 빈 값은 허용하지 않는 제약조건이 설정되어 있음
    - 빈 값은 is_valid()에 의해 False로 평가되고 form 객체에 맞는 에러 메시지가 포함되어 다음 코드로 진행됨
    
    ![image.png](attachment:fec77700-6f9f-49c4-bcdb-a780ef301500:image.png)
    

- ModelForm을 적용한 edit 로직
    
    ![image.png](attachment:aa1926f0-d0d4-480a-ad9f-99e8a3ce7201:image.png)
    
- ModelForm을 적용한 update 로직
    
    ![image.png](attachment:2df1ccfd-6f73-4f57-b400-642085252b92:image.png)
    

**save() 메서드**

: 데이터 베이스 객체를 만들고 저장하는 ModelForm의 인스턴스 메서드

→ 폼 데이터가 유효한 경우, save() 메서드를 호출하면 모델 인스턴스를 생성하고 데이터 베이스에 저장됨

→ instance 인자를 통해 새 객체 생성과 기존 객체 수정도 구분할 수 있음

⇒ 코드 없이 손쉽게 DB 연동이 가능함

- save() 메서드가 생성과 수정을 구분하는 방법
    
    : 키워드 인자 instance 여부를 통해 생성할 지, 수정할 지를 결정
    
    ![image.png](attachment:11cc5269-2ba9-4494-bccc-84c16d741ee5:image.png)
    

**Django Form 정리**

- 사용자로부터 데이터를 수집하고 처리하기 위한 강력하고 유연한 도구
- HTML form의 생성, 데이터 유효성 검사 및 처리를 쉽게 할 수 있도록 도움

---

### View 함수 구조 변화

- new & create view 함수 간 공통점과 차이점
    - 공통점
        
        : 데이터 생성을 구현하기 위함
        
    - 차이점
        
        : new는 GET method 요청만, create는 POST method 요청만을 처리함
        

- view 함수 구조화의 목적
    
    : HTTP request method 차이점을 활용해 동일한 목적을 가지는 2개의 view 함수를 하나로 구조화
    

### new & create 함수 결합

![image.png](attachment:17a5127f-f928-440d-9646-8b5721fa1d4f:image.png)

![image.png](attachment:1ea47df1-0739-4c46-8dde-afd6a711b41a:image.png)

- 새로운 create view 함수
    - new와 create view 함수의 공통점과 차이점을 기반으로 하나의 함수로 결합
    
    ![image.png](attachment:a6e5c60d-d40b-4813-92b1-2a4beffc8c91:image.png)
    
    - 두 함수의 유일한 차이점이었던 request method에 따른 분기
    
    ![image.png](attachment:00d99600-f672-446c-936d-7221aceaefd7:image.png)
    
    - POST일 때는 과거 create 함수 구조였던 객체 생성 및 저장 로직 처리
    
    ![image.png](attachment:80e28cd5-68a3-46ac-98ec-c7865de7f708:image.png)
    
    - POST가 아닐 때는 과거 new 함수에서 진행했던 form 인스턴스 생성
    
    ![image.png](attachment:ef974e7b-54b4-475c-a1ce-6617548146e3:image.png)
    
    - context에 담기는 form은
        1. is_valid()를 통과하지 못해 에러 메시지를 담은 form
        2. else 문을 통한 form 인스턴스
        
        ![image.png](attachment:b4710432-63fe-48bc-bd1a-1972aedc5199:image.png)
        

- 기존 new 관련 코드 수정
    - 사용하지 않게 된 new url 제거
    
    ![image.png](attachment:d51a3f4e-18f9-4a19-aca8-88057419e908:image.png)
    
    - new 관련 키워드를 create로 변경
    
    ![image.png](attachment:c6831965-77d2-4200-9449-078777704409:image.png)
    
    ![image.png](attachment:eb5fb5a8-eeff-4287-b162-e61813388a10:image.png)
    

- request method에 따른 요청의 변화
    - (GET) : articles/create/ ⇒ 게시글 생성 페이지를 줘!
    - (POST) : articles/create/ ⇒ 게시글을 생성해줘!

### edit & update 함수 결합

- 새로운 update view 함수
    - 기존 edit과 update view함수 결합
    
    ![image.png](attachment:c4791651-1837-4e2e-b99a-c863303b6384:image.png)
    
- 기존 edit 관련 코드 수정
    - 사용하지 않는 edit url 제거
    
    ![image.png](attachment:655317ff-c793-40f2-ae26-d8a8276997ab:image.png)
    
    - edit 관련 키워드를 update로 변경
    
    ![image.png](attachment:62b2ceaa-a847-45a1-bdc5-beae026645c1:image.png)
    

---